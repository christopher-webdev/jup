(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[38487],{71130:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(93981),s=n(50269),i=n(24201),a=n(29541),o=function(e){var t=e.children,n=e.className,s=void 0===n?"":n,o=e.height,l=e.maxHeight,c=e.expanded,u=(0,r.useState)(o),d=u[0],m=u[1];(0,r.useEffect)((function(){m(c?l:o)}),[o,l,c]);var p=c?"animate-fade-in":"animate-fade-out";return(0,a.jsx)("div",{className:(0,i.cn)("overflow-hidden transition-all duration-200",p,s),style:{height:d,maxHeight:l},children:t})},l=function(e){var t=e.message,n=e.iconSize,r=void 0===n?20:n,l=e.className;return(0,a.jsx)(o,{height:0,maxHeight:"auto",expanded:Boolean(t),children:(0,a.jsxs)("div",{className:(0,i.cn)("mt-1 flex items-center fill-current text-xs font-semibold text-white md:px-6",l),children:[(0,a.jsx)(s.Z,{width:r,style:{minWidth:r},height:r}),(0,a.jsx)("span",{className:"ml-2",children:t})]})})}},19424:function(e,t,n){"use strict";n(93981);var r=n(12869),s=n(24201),i=n(29541);t.Z=function(e){var t=e.children;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.Z,{product:"perps",className:"z-10 w-full sm:max-w-[90vw] md:w-[460px]",activeClassName:"my-2 lg:my-4"}),(0,i.jsx)("div",{className:(0,s.cn)("bg-v2-perps flex min-h-full w-full max-w-[100vw] flex-1"),children:t})]})}},21039:function(e,t,n){"use strict";n.d(t,{Ne:function(){return u},QY:function(){return c}});var r=n(97620),s=n(3082),i=n(93981),a=n(72215),o=n(6397),l=[o.Zt,o.ih,o.Eo],c=function(){var e=(0,a.Bn)().topTokenByVolume;return(0,i.useMemo)((function(){var t=l.map((function(e){return e.address})),n=e.map((function(e){return e.address})).concat(t),r=new Set;return n.forEach((function(e){return r.add(e)})),Array.from(r)}),[e])},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"SOL-SOL",t="perps",n=(0,s.useRouter)(),o=n.isReady,l=n.query,c=n.replace,u=(0,a.Bn)(),d=u.getTokenSlug;return i.useCallback((function(n,s,i){if(o)if(n&&s){var a=d(n),u=d(s);if("string"===typeof l.inOut){var m=l.inOut.split("-"),p=(0,r.Z)(m,2),f=p[0],x=p[1],h=l.direction;f===a&&x===u&&h===i||c({pathname:"/".concat(t,"/").concat(i,"/").concat(a,"-").concat(u)},void 0,{scroll:!1,shallow:!0})}}else c({pathname:"/".concat(t,"/").concat(i,"/").concat(e)},void 0,{scroll:!1,shallow:!0})}),[o,d,l.inOut,l.direction,c,e])}},8770:function(e,t,n){"use strict";n.d(t,{h:function(){return a}});var r=n(24309),s=n(55540),i=n(13486),a=function(e,t){var n=new r.Y7(t,e,{commitment:"processed",skipPreflight:!0});return new r.$r(s.x,i.KX,n)}},12939:function(e,t,n){"use strict";var r=n(24201),s=n(29541);t.Z=function(e){var t=e.children,n=e.className,i=e.animate,a=void 0===i||i;return(0,s.jsx)("span",{className:(0,r.cn)("from-[rgba(199,242,132,1))] bg-v2-text-gradient to-[rgba(0,190,240,1)] bg-clip-text text-transparent",n,{"animate-shine":a}),children:t})}},99384:function(e,t,n){"use strict";var r=n(29541);t.Z=function(e){var t=e.width,n=void 0===t?12:t,s=e.height,i=void 0===s?12:s;return(0,r.jsxs)("svg",{width:n,height:i,viewBox:"0 0 12 12",fill:"inherit",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("g",{clipPath:"url(#clip0_841_4053)",children:(0,r.jsx)("path",{d:"M11.6466 4.23513V0.706082L10.4111 1.94156C9.3173 0.741165 7.72912 0 6 0C2.6827 0 0 2.6827 0 6C0 9.3173 2.68203 12 6 12C7.69405 12 9.21142 11.2939 10.3059 10.165L9.31797 9.14128C8.50601 10.0234 7.30561 10.5879 6 10.5879C3.45892 10.5879 1.41216 8.5411 1.41216 6.00002C1.41216 3.45894 3.45892 1.41218 6 1.41218C7.34135 1.41218 8.57615 2.01238 9.42317 2.92954L8.11757 4.23515L11.6466 4.23513Z",fill:"inherit"})}),(0,r.jsx)("defs",{children:(0,r.jsx)("clipPath",{id:"clip0_841_4053",children:(0,r.jsx)("rect",{width:"12",height:"12",fill:"white"})})})]})}},94223:function(e,t,n){"use strict";n(93981);var r=n(29541);t.Z=function(e){var t=e.width,n=void 0===t?32:t,s=e.height,i=void 0===s?32:s;return(0,r.jsx)("svg",{width:n,height:i,viewBox:"0 0 32 32",fill:"inherit",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.1425 8.45597H5.22047L5.22025 8.45592C4.66944 8.40838 4.15821 8.1496 3.79392 7.73368C3.52351 7.52371 3.34106 7.22064 3.28188 6.88329C3.24718 5.65089 4.6625 4.79883 5.9425 4.79883H22.3996C23.1264 4.80107 23.8229 5.09067 24.3368 5.60455C24.8507 6.11843 25.1403 6.81496 25.1425 7.54168V8.45597ZM26.0564 10.2846H5.02779C4.54289 10.2846 4.07777 10.092 3.73473 9.74912C3.39187 9.40605 3.19922 8.94094 3.19922 8.45605V25.8275C3.19922 26.555 3.4882 27.2526 4.00248 27.7671C4.51698 28.2814 5.21451 28.5703 5.94208 28.5703H26.0564C26.7839 28.5703 27.4814 28.2814 27.996 27.7671C28.5102 27.2526 28.7992 26.555 28.7992 25.8275V23.0846H24.2278C22.9213 23.0846 21.7139 22.3875 21.0607 21.2561C20.4074 20.1246 20.4074 18.7303 21.0607 17.5989C21.7139 16.4675 22.9213 15.7703 24.2278 15.7703H28.7992V13.0275C28.7992 12.2999 28.5102 11.6024 27.996 11.0879C27.4815 10.5736 26.7839 10.2846 26.0564 10.2846ZM22.4014 19.4277C22.4014 19.9126 22.594 20.3777 22.9369 20.7208C23.2799 21.0636 23.7451 21.2563 24.2299 21.2563H28.8014V17.5991H24.2299C23.745 17.5991 23.2799 17.7918 22.9369 18.1346C22.594 18.4777 22.4014 18.9428 22.4014 19.4277Z",fill:"currentColor"})})}},71932:function(e,t,n){"use strict";var r=n(63956),s=n(54423),i=(n(93981),n(29541)),a=["width","height"];function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=function(e){var t=e.width,n=void 0===t?"12":t,r=e.height,o=void 0===r?"12":r,c=(0,s.Z)(e,a);return(0,i.jsx)("svg",l(l({width:n,height:o,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c),{},{children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10C2 5.58172 5.58172 2 10 2C14.4183 2 18 5.58172 18 10ZM9.93793 12.1728C9.47107 12.1733 9.08835 11.8037 9.07186 11.3372L8.86888 5.61643C8.86042 5.3813 8.94838 5.15338 9.11162 4.98422C9.27485 4.81507 9.49982 4.71992 9.73494 4.71992H10.1409C10.376 4.71992 10.601 4.81507 10.7642 4.98422C10.9275 5.15338 11.0154 5.38131 11.007 5.61643L10.804 11.3372C10.7875 11.8037 10.4048 12.1733 9.93793 12.1728ZM9.93783 15.4176C10.6106 15.4176 11.1557 14.8725 11.1557 14.1997C11.1557 13.5269 10.6106 12.9818 9.93783 12.9818C9.26502 12.9818 8.71992 13.5269 8.71992 14.1997C8.71992 14.8725 9.26502 15.4176 9.93783 15.4176Z",fill:"currentColor"})}))}},82875:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSG:function(){return _e},default:function(){return Ie}});var r=n(93981),s=n(19424),i=n(97620),a=n(70107),o=n(8473),l=n(4707),c=n(72215),u=n(25224),d=n(13838),m=n(68586),p=n(64508),f=n.n(p),x=n(99438),h=n(29541),v=function(e){var t=e.background,n=e.shadow,r=e.children;return(0,h.jsx)("div",{style:{overflow:"auto",backgroundImage:["linear-gradient(to right, ".concat(t,", ").concat(t,")"),"linear-gradient(to right, ".concat(t,", ").concat(t,")"),"linear-gradient(to right, ".concat(n,", rgba(255, 255, 255, 0))"),"linear-gradient(to left, ".concat(n,", rgba(255, 255, 255, 0))")].join(","),backgroundPosition:"left center, right center, left center, right center",backgroundRepeat:"no-repeat",backgroundColor:t,backgroundSize:"10px 100%, 10px 100%, 10px 100%, 10px 100%",backgroundAttachment:"local, local, scroll, scroll"},children:r})},g=n(56100),w=n(40558),b=n(24628),j=n(50269),y=n(6397),P=n(13486),N=n(22663),k=n(27195),S=n(8857),A=n.n(S),Z=n(7744),T=n(65558),C=n.n(T),M=n(39268),_=n.n(M),I=n(13215),V=n(24201),L=n(12939),B=n(85394),R=n(96404),E=n(13170),O=n(94223),K=n(9319),D=n.n(K),F=n(13154),H=n(14640),U=n(24684),q=n(71932),W=n(23933),z=n(24309),J=n(75206),G=n(8770),Q=function(){var e=(0,k.Z)(A().mark((function e(t,n){var r;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMultipleAccountsInfo(n.map((function(e){return new Z.PublicKey(e)})));case 2:return r=e.sent,e.abrupt("return",r.reduce((function(e,t,r){var s=n[r];if(t){var i=new Z.AddressLookupTableAccount({key:new Z.PublicKey(s),state:Z.AddressLookupTableAccount.deserialize(t.data)});e.push(i)}return e}),new Array));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Y=n(32532),X=n(8862);function $(e){return ee.apply(this,arguments)}function ee(){return(ee=(0,k.Z)(A().mark((function e(t){var n,r,s,o,l,c,u,d,m,p,f,x,h,v,g,w,b,j,y,N,k,S,T,C,M,_,I,V,L,B,R;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lpTokenMint,r=t.wallet,s=t.publicKey,o=t.connection,l=t.custody,c=t.payAmount,u=t.minReceiveAmount,d=t.originalTokenAmount,m=t.custodyMetas,p=t.getSwapIx,f=t.blockhash,e.prev=1,x=(0,G.h)(r,o),e.next=5,(0,Y.c1)(n,s,o);case 5:return h=e.sent,v=(0,i.Z)(h,2),g=v[0],w=v[1],e.next=11,(0,Y.c1)(l.account.mint,s,o);case 11:if(b=e.sent,j=(0,i.Z)(b,2),y=j[0],N=j[1],k=[],w&&k.push(w),N&&k.push(N),!l.account.mint.equals(E.W4)||p){e.next=23;break}return e.next=21,o.getBalance(y);case 21:S=e.sent,c.gt(new z.BN(S))&&(k.push(Z.SystemProgram.transfer({fromPubkey:s,toPubkey:y,lamports:BigInt(c.toString())})),k.push(J.WU.createSyncNativeInstruction(J.H_,y)));case 23:return T=X.zC[l.publicKey.toString()],e.next=26,x.methods.addLiquidity2({tokenAmountIn:c,minLpAmountOut:u,tokenAmountPreSwap:d}).accounts({owner:s,fundingAccount:y,lpTokenAccount:g,transferAuthority:P.oW,perpetuals:P.TJ,pool:P.FW,custody:l.publicKey,custodyDovesPriceAccount:T.dovesOracle,custodyPythnetPriceAccount:T.pythnetOracle,custodyTokenAccount:l.account.tokenAccount,lpTokenMint:n,tokenProgram:J.H_}).remainingAccounts(m).instruction();case 26:return C=e.sent,M=[Z.ComputeBudgetProgram.setComputeUnitLimit({units:14e5})].concat(k),e.t0=a.Z,e.next=31,Q(o,[P.vN]);case 31:if(e.t1=e.sent,_=(0,e.t0)(e.t1),!p){e.next=43;break}return e.next=36,p({userPublicKey:s});case 36:I=e.sent,V=I.swapInstruction,L=I.addressLookupTableAccounts,_.push.apply(_,(0,a.Z)(L)),M.push(V,C),e.next=44;break;case 43:M.push(C);case 44:return B=new Z.TransactionMessage({payerKey:s,recentBlockhash:f,instructions:M}).compileToV0Message(_),R=new Z.VersionedTransaction(B),e.abrupt("return",R);case 49:throw e.prev=49,e.t2=e.catch(1),console.log(e.t2),e.t2;case 53:case"end":return e.stop()}}),e,null,[[1,49]])})))).apply(this,arguments)}function te(e){return ne.apply(this,arguments)}function ne(){return(ne=(0,k.Z)(A().mark((function e(t){var n,r,s,o,l,c,u,d,m,p,f,x,h,v,g,w,b,j,y,N,k,S,T,C,M,_,I,V,L,B,R;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.lpTokenMint,r=t.wallet,s=t.publicKey,o=t.connection,l=t.custody,c=t.payAmount,u=t.minReceiveAmount,d=t.custodyMetas,m=t.shouldCloseLpTokenAccount,p=t.getSwapIx,f=t.blockhash,e.prev=1,x=(0,G.h)(r,o),e.next=5,(0,Y.c1)(n,s,o);case 5:return h=e.sent,v=(0,i.Z)(h,1),g=v[0],e.next=10,(0,Y.c1)(l.account.mint,s,o);case 10:return w=e.sent,b=(0,i.Z)(w,2),j=b[0],y=b[1],N=[],y&&N.push(y),k=[],m&&k.push(J.WU.createCloseAccountInstruction(J.H_,g,s,s,[])),l.account.mint.equals(E.W4)&&k.push(J.WU.createCloseAccountInstruction(J.H_,j,s,s,[])),S=X.zC[l.publicKey.toString()],e.next=22,x.methods.removeLiquidity2({lpAmountIn:c,minAmountOut:u}).accounts({owner:s,receivingAccount:j,lpTokenAccount:g,transferAuthority:P.oW,perpetuals:P.TJ,pool:P.FW,custody:l.publicKey,custodyDovesPriceAccount:S.dovesOracle,custodyPythnetPriceAccount:S.pythnetOracle,custodyTokenAccount:l.account.tokenAccount,lpTokenMint:n,tokenProgram:J.H_}).remainingAccounts(d).instruction();case 22:return T=e.sent,C=[Z.ComputeBudgetProgram.setComputeUnitLimit({units:14e5})].concat(N),e.t0=a.Z,e.next=27,Q(o,[P.vN]);case 27:if(e.t1=e.sent,M=(0,e.t0)(e.t1),!p){e.next=40;break}return e.next=32,p({userPublicKey:s});case 32:_=e.sent,I=_.swapInstruction,V=_.tokenLedgerInstruction,L=_.addressLookupTableAccounts,M.push.apply(M,(0,a.Z)(L)),C.push(V,T,I),e.next=41;break;case 40:C.push(T);case 41:return C.push.apply(C,k),B=new Z.TransactionMessage({payerKey:s,recentBlockhash:f,instructions:C}).compileToV0Message(M),R=new Z.VersionedTransaction(B),e.abrupt("return",R);case 47:throw e.prev=47,e.t2=e.catch(1),console.log(e.t2),e.t2;case 51:case"end":return e.stop()}}),e,null,[[1,47]])})))).apply(this,arguments)}var re=n(95674),se=n(90342),ie=n(795).Buffer,ae=function(e){var t=e.fromPairValue,n=e.fromPairTokenInfo,s=(0,se.gs)().userMaxFeeInLamports,a=(0,c.Bn)(),o=a.connection,m=a.getTokenInfo,p=(0,P.tc)(),f=p.perpsTokens,x=p.oraclePrices,h=p.poolInfo,v=p.custodies,g=(0,r.useMemo)((function(){if(x&&h){var e=v.map((function(e){var t=e.account,n=t.mint,r=t.assets,s=t.decimals,i=t.targetRatioBps,a=x[n.toString()];if(!a)return null;var o=r.owned,l=new d.Z(a).mul(o.toString()).div(Math.pow(10,s)).toDP(2),c=l.gt(0)?l.div(h.poolAumUsd).mul(100).toNearest(.01,d.Z.ROUND_DOWN).toNumber():0;return{mint:n.toString(),weightage:new d.Z(i.toString()).sub(100*c)}})).filter(Boolean).sort((function(e,t){return t.weightage.toNumber()-e.weightage.toNumber()}));return 0===e.length?null:m(e[0].mint)}}),[x,h,v,m]),w=(0,r.useMemo)((function(){var e=Object.values(f).flat();return!Boolean(e.find((function(e){return e.address===n.address})))}),[n.address,f]),b=(0,r.useMemo)((function(){return(0,u.Hd)(t)?D().BigInt(new d.Z(t).mul(Math.pow(10,n.decimals)).round().toFixed()||0):D().BigInt(0)}),[t,n.decimals]),j=(0,re.OO)({amount:b,inputMint:n&&w?new Z.PublicKey(n.address):void 0,outputMint:g&&w?new Z.PublicKey(g.address):void 0,slippageBps:1e4,maxAccounts:45}),y=j.quoteResponseMeta,N=j.loading,S=j.error,T=j.refresh,C=(0,r.useCallback)(function(){var e=(0,k.Z)(A().mark((function e(t){var r,a,l,c,u,d,m,p,f,x,v,w,b,j;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.userPublicKey,e.prev=1,y&&g&&h){e.next=4;break}throw new Error("Invalid quote response");case 4:return e.next=6,(0,Y.c1)(new Z.PublicKey(n.address),r,o);case 6:return l=e.sent,c=(0,i.Z)(l,1),u=c[0],e.next=11,(0,Y.c1)(new Z.PublicKey(g.address),r,o);case 11:return d=e.sent,m=(0,i.Z)(d,1),p=m[0],f={quoteResponse:y.original,userPublicKey:r.toBase58(),wrapAndUnwrapSol:!1,prioritizationFeeLamports:s,sourceTokenAccount:u,destinationTokenAccount:p},e.next=17,fetch("https://quote-api.jup.ag/v6/swap-instructions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});case 17:return e.next=19,e.sent.json().catch(function(){var e=(0,k.Z)(A().mark((function e(t){var n,r,s;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:return n=e.sent,r=n.error,s=n.message,e.abrupt("return",{error:new Y.qw(s,void 0,r)});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 19:if(!("error"in(a=e.sent))){e.next=22;break}throw new Error(a.error.message);case 22:return v=(x=a).swapInstruction,w=x.addressLookupTableAddresses,b=new Z.TransactionInstruction({programId:new Z.PublicKey(v.programId),keys:v.accounts.map((function(e){return{pubkey:new Z.PublicKey(e.pubkey),isSigner:e.isSigner,isWritable:e.isWritable}})),data:ie.from(v.data,"base64")}),e.next=26,Q(o,w);case 26:return j=e.sent,e.abrupt("return",{swapInstruction:b,addressLookupTableAccounts:j});case 30:throw e.prev=30,e.t0=e.catch(1),e.t0;case 33:case"end":return e.stop()}}),e,null,[[1,30]])})));return function(t){return e.apply(this,arguments)}}(),[g,s,o,n.address,h,y]),M=(0,r.useMemo)((function(){return null===y||void 0===y?void 0:y.quoteResponse.outAmount}),[y]),_=(0,r.useMemo)((function(){if(w&&S)return l.ag._({id:"pzwWY5"})}),[S,w]);return{isLoading:N,quoteResponseMeta:y,basketTokenWithLowestFee:g,isTokenSwapRequired:w,outAmount:M,getSwapIx:C,hasJupiterError:_,refresh:T}},oe=n(56720),le=n(65895),ce=n(40993),ue=n(3011),de=n(71130),me=n(41264),pe=n(33130),fe=n(55540),xe=n(83962),he=function(e){var t=e.onClick,n=e.label,r=e.isActive;return(0,h.jsx)("button",{type:"button",onClick:t,className:(0,V.cn)("flex flex-row items-center justify-center border-b px-3 py-4 font-semibold",r?"border-b-labs text-labs":"border-transparent"),children:(0,h.jsx)("span",{className:"text-sm",children:n})})},ve=function(e){var t=e.refresh,n=e.action,r=e.setAction,s=e.isLoading;return(0,h.jsxs)("div",{className:"flex h-[56px] flex-row items-center justify-between space-x-4 border-b border-b-white/5 px-4",children:[(0,h.jsxs)("div",{className:"flex w-full flex-row",children:[(0,h.jsx)(he,{isActive:"viaSwap"===n,label:l.ag._({id:"JHxGP5"}),onClick:function(){return r("viaSwap")}}),(0,h.jsx)(he,{isActive:"buy"===n,label:l.ag._({id:"qiOIiY"}),onClick:function(){return r("buy")}}),(0,h.jsx)(he,{isActive:"sell"===n,label:l.ag._({id:"xNB0TS"}),onClick:function(){return r("sell")}})]}),t&&(0,h.jsx)("div",{className:"flex h-7 items-center",children:(0,h.jsx)(xe.Z,{isLoading:s,refresh:t})})]})},ge=function(){var e=(0,P.tc)().poolInfo,t=(0,c.FB)(null===e||void 0===e?void 0:e.lpTokenInfo.address,null===e||void 0===e?void 0:e.lpTokenInfo.decimals),n=(0,r.useMemo)((function(){return null!==e&&void 0!==e&&e.maxAumUsd.gt(0)?e.maxAumUsd:new d.Z(Number.MAX_VALUE)}),[e]),s=(0,r.useMemo)((function(){return null!==e&&void 0!==e&&e.maxAumUsd.gt(0)?e.maxAumUsd.minus(e.poolAumUsd):new d.Z(0)}),[e]),i=(0,r.useMemo)((function(){return e?s:new d.Z(0)}),[s,e]);return{lpTokenUserBalance:t,totalAUMQuotas:n,availableAUMQuotas:s,availableDepositQuotas:i}};function we(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return be(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,s=function(){};return{s:s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw i}}}}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var je=_()((function(){return n.e(64642).then(n.bind(n,64642))}),{ssr:!1,loadableGenerated:{webpack:function(){return[64642]}}}),ye=function(e){var t=e.action,n=e.setAction,s=(0,c.Bn)(),m=s.connection,p=s.getTokenInfo,v=s.tokens,g=(0,c.Os)(),w=g.wallet,b=g.signTransaction,j=(0,c.C9)(),S=(0,P.tc)(),T=S.viewClient,M=S.refreshViews,_=S.poolInfo,K=S.slippage,z=S.perpsTokens,J=S.custodies,G=ge(),Q=G.availableAUMQuotas,X=G.availableDepositQuotas,ee=(0,pe.R3)(),te=(0,ue.KO)(ce.yz),ne=(0,i.Z)(te,1)[0],re=(0,se.gs)().priorityLevel,ie=(0,I.cI)({defaultValues:{fromPair:y.Lr.toString(),fromPairValue:"",toPair:"",toPairValue:"",feeBps:""}}),xe=ie.control,he=ie.handleSubmit,be=ie.watch,ye=ie.setValue,Pe=ie.formState,Ne=be(),ke=(0,r.useMemo)((function(){return p(Ne.fromPair)||y.Zt}),[p,Ne.fromPair]),Se=(0,r.useMemo)((function(){return(null===_||void 0===_?void 0:_.lpTokenInfo)||y.Zt}),[_]);(0,r.useEffect)((function(){ye("fromPair",ke.address)}),[ke,ye]);var Ae=ae({fromPairValue:Ne.fromPairValue,fromPairTokenInfo:ke}),Ze=Ae.isLoading,Te=Ae.quoteResponseMeta,Ce=Ae.basketTokenWithLowestFee,Me=Ae.isTokenSwapRequired,_e=Ae.outAmount,Ie=Ae.getSwapIx,Ve=Ae.hasJupiterError,Le=Ae.refresh,Be=(0,r.useMemo)((function(){return T&&Ce?{poolCustodyAccount:Me?J.find((function(e){return e.account.mint.toBase58()===Ce.address})):J.find((function(e){return e.account.mint.toBase58()===ke.address}))}:{poolCustodyAccount:null}}),[T,Ce,Me,J,ke.address]).poolCustodyAccount,Re=(0,c.FB)(Ne.fromPair,ke.decimals).balance,Ee=(0,r.useCallback)((function(e){var t;e.preventDefault(),t=Ne.fromPair===E.W4.toBase58()?new d.Z(Re).gt(oe.WO)?new d.Z(Re).minus(oe.WO).toString():"0":String(Re),ye("fromPairValue",t)}),[Re,Ne.fromPair,ye]),Oe=(0,r.useMemo)((function(){if(null===w||void 0===w||!w.adapter.connected)return!1;if((null===ke||void 0===ke?void 0:ke.address)!==E.W4.toBase58())return!1;if(!(0,u.Hd)(Ne.fromPairValue))return!1;var e=new d.Z(Re).minus(oe.WO);return new d.Z(Ne.fromPairValue||0).gt(e)}),[null===ke||void 0===ke?void 0:ke.address,Re,null===w||void 0===w?void 0:w.adapter.connected,Ne.fromPairValue]),Ke=(0,r.useMemo)((function(){return!(0,u.Hd)(Ne.fromPairValue)||new d.Z(Ne.fromPairValue).gt(Re)}),[Re,Ne.fromPairValue]),De=(0,r.useMemo)((function(){return Q.lt(0)}),[Q]),Fe=(0,r.useMemo)((function(){return X.lt(new d.Z(Ne.toPairValue||0))}),[X,Ne.toPairValue]),He=(0,c.iG)(),Ue=(0,r.useMemo)((function(){var e,t=null===(e=He.account)||void 0===e?void 0:e.account.lamports;return!t||t<oe.WO}),[He.account]),qe=(0,r.useMemo)((function(){return Ue||Ke||Pe.isSubmitting||!Ne.toPairValue||Fe||Oe||Boolean(Ve)}),[Ue,Ke,Pe.isSubmitting,Ne.toPairValue,Fe,Oe,Ve]),We=(0,r.useMemo)((function(){return Ne.toPairValue&&(0,u.Hd)(Ne.toPairValue)?new(C())(new d.Z(Ne.toPairValue).mul(Math.pow(10,Se.decimals)).mul(100-K).div(100).toDP(0).toFixed()):new(C())(0)}),[Ne.toPairValue,Se.decimals,K]),ze=r.useCallback(function(){var e=(0,k.Z)(A().mark((function e(t){var n,r,s,a,o,c,u,p,f,x,h,v;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.fromPairValue,r=t.toPairValue,!qe&&T&&null!==w&&void 0!==w&&w.adapter.publicKey&&n&&r&&_&&!We.eqn(0)&&Be&&b){e.next=3;break}return e.abrupt("return");case 3:if(e.prev=3,w.adapter.publicKey){e.next=6;break}return e.abrupt("return",null);case 6:return e.next=8,m.getLatestBlockhash("confirmed");case 8:if(s=e.sent,a=s.blockhash,o=s.lastValidBlockHeight,c={lpTokenMint:new Z.PublicKey(_.lpMint),wallet:w,publicKey:w.adapter.publicKey,connection:m,custody:Be,minReceiveAmount:We,custodyMetas:T.getCustodyMetas(),getSwapIx:null,blockhash:a,originalTokenAmount:null,payAmount:new(C())(0)},!Me){e.next=39;break}if(c.payAmount=new(C())(0),c.getSwapIx=Ie,Ce){e.next=17;break}throw new Error("can't find basketTokenWithLowestFee");case 17:return e.next=19,(0,Y.c1)(new Z.PublicKey(Ce.address),w.adapter.publicKey,m);case 19:if(u=e.sent,p=(0,i.Z)(u,2),f=p[0],!p[1]){e.next=27;break}c.originalTokenAmount=new(C())(0),e.next=37;break;case 27:return e.prev=27,e.next=30,m.getTokenAccountBalance(f,"confirmed");case 30:x=e.sent,c.originalTokenAmount=new(C())(x.value.amount),e.next=37;break;case 34:throw e.prev=34,e.t0=e.catch(27),new Error("Failed to get userATA balance");case 37:e.next=42;break;case 39:c.payAmount=new(C())(new d.Z(n).mul(Math.pow(10,ke.decimals)).toFixed()),c.originalTokenAmount=null,c.getSwapIx=null;case 42:return e.next=44,$(c);case 44:return h=e.sent,e.next=47,ee(h,{blockhash:a,lastValidBlockHeight:o,idl:fe.x,idlProgramId:P.KX,skipPreflight:!0},{submittingMessage:l.ag._({id:"5ZovYa",values:{0:ke.symbol,1:Se.symbol,PERPS_LP_TICKER:N.t,fromPairValue:n,toPairValue:r}}),successMessage:l.ag._({id:"GOfH9+",values:{0:ke.symbol,1:Se.symbol,fromPairValue:n,toPairValue:r}}),errorMessage:l.ag._({id:"qKpZrm",values:{PERPS_LP_TICKER:N.t}}),referenceFee:"MEDIUM"===re?ne.perps.m:"HIGH"===re?ne.perps.h:"VERY_HIGH"===re?ne.perps.vh:void 0,minimumFee:ce.uo,requestComputeBudgetLimit:5e5});case 47:if(!("error"in(v=e.sent))){e.next=50;break}throw v.error;case 50:ye("fromPairValue",""),ye("toPairValue",""),e.next=57;break;case 54:e.prev=54,e.t1=e.catch(3),console.error("Failed to buy into LP pool",e.t1);case 57:return e.prev=57,j(),M(),e.finish(57);case 61:case"end":return e.stop()}}),e,null,[[3,54,57,61],[27,34]])})));return function(t){return e.apply(this,arguments)}}(),[qe,T,w,_,We,Be,b,m,Me,ee,ke.symbol,ke.decimals,Se.symbol,ye,Ie,Ce,re,ne.perps.m,ne.perps.h,ne.perps.vh,j,M]),Je=(0,r.useCallback)((function(e){ye("fromPair",e.address.toString()),ye("fromPairValue","")}),[ye]),Ge=r.useMemo((function(){if(Ne.fromPairValue&&Ne.toPairValue){if(Ke||Ue||Oe)return l.ag._({id:"UsQ5AM",values:{0:Ue?"SOL":ke.symbol}});if(Fe)return l.ag._({id:"d9DipV"});if(Pe.isSubmitting)return(0,h.jsxs)("span",{className:"flex items-center justify-center",children:[(0,h.jsx)(B.Z,{className:"!h-4 !w-4",baseColor:"white",spinnerColor:"black"}),(0,h.jsx)("div",{className:"mr-2"}),l.ag._({id:"0cnxS9",values:{PERPS_LP_TICKER:N.t}})]})}return(0,h.jsx)(L.Z,{children:(0,h.jsx)(o.cC,{id:"qiOIiY"})})}),[Pe.isSubmitting,ke.symbol,Ke,Ue,Fe,Oe,Ne.fromPairValue,Ne.toPairValue]),Qe=(0,r.useMemo)((function(){var e;return Boolean(null===w||void 0===w||null===(e=w.adapter.supportedTransactionVersions)||void 0===e?void 0:e.has(0))}),[null===w||void 0===w?void 0:w.adapter.supportedTransactionVersions]),Ye=(0,r.useMemo)((function(){if(null!==w&&void 0!==w&&w.adapter.connected&&!Qe)return[].concat((0,a.Z)(z.nonStableTokens),(0,a.Z)(z.stableTokens)).map((function(e){return e.address}));var e,t=[],n=we(v);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.address!==(null===_||void 0===_?void 0:_.lpTokenInfo.address)&&t.push(r.address)}}catch(s){n.e(s)}finally{n.f()}return t}),[z.nonStableTokens,z.stableTokens,null===_||void 0===_?void 0:_.lpTokenInfo.address,v,Qe,null===w||void 0===w?void 0:w.adapter.connected]),Xe=(0,r.useState)(!1),$e=Xe[0],et=Xe[1],tt=(0,r.useState)(""),nt=tt[0],rt=tt[1],st=(0,r.useState)((new Date).getTime()),it=st[0],at=st[1],ot=(0,r.useMemo)((function(){return Me&&Ze||$e}),[Ze,Me,$e]);(0,U.Gl)(ot||!Me||null===Te||void 0===Te?void 0:Te.quoteResponse,ke.address,(null===Ce||void 0===Ce?void 0:Ce.address)||"");var lt=(0,H.Z)({selectedRoute:Te,hasEnoughSOL:!Ue}).errors,ct=(0,r.useMemo)((function(){var e=[];return Oe&&e.push(l.ag._({id:"p6yX1j",values:{MINIMUM_SOL_BALANCE:oe.WO}})),e}),[Oe]),ut=(0,r.useCallback)((function(){if(!T||!Ne.fromPairValue||!(0,u.Hd)(Ne.fromPairValue)||!ke.address||!Be)return ye("toPairValue",""),ye("feeBps",""),void rt("");if(et(!0),!(Me?Ce:ke))throw new Error("tokenInfoToUse is null");var e=Me?_e?new(C())(_e.toString()):null:new(C())(new d.Z(Ne.fromPairValue).mul(Math.pow(10,ke.decimals)).toDP(0).toFixed());e&&!e.eqn(0)&&T.getAddLiquidityAmountAndFee(Be,e).then((function(e){if(e&&!("code"in e))ye("toPairValue",new d.Z(e.amount.toString()).div(1e6).toString()),ye("feeBps",e.feeBps.toString()),rt("");else{ye("toPairValue",""),ye("feeBps","");var t=e&&6003===e.code?l.ag._({id:"QdIt4g"}):null;rt(l.ag._({id:"hevP3C",values:{PERPS_LP_TICKER:N.t,reason:t}}))}})).catch(console.log).finally((function(){at((new Date).getTime()),et(!1)}))}),[Ce,ke,Me,_e,Be,ye,T,Ne.fromPairValue]);(0,r.useEffect)((function(){Me?Te&&ut():ut()}),[Ne.fromPairValue,ke.address,K,Te]);var dt=(0,r.useMemo)((function(){return Ne.feeBps&&Ne.fromPairValue&&Ne.toPairValue?"".concat(new d.Z(Ne.feeBps).div(100).toString(),"%"):""}),[Ne.feeBps,Ne.fromPairValue,Ne.toPairValue]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(ve,{action:t,setAction:n,refresh:function(){Le(),ut()},isLoading:ot}),(0,h.jsxs)("div",{className:"px-4 pb-5 pt-2",children:[(0,h.jsx)(de.Z,{iconSize:12,className:"mb-2 rounded-lg bg-v2-lily/10 !p-2 !text-v2-lily",message:(0,h.jsxs)("div",{className:"flex flex-col",children:[(0,h.jsx)("span",{children:l.ag._({id:"SHnvMH"})}),(0,h.jsx)(f(),{href:"/limit/USDC-".concat(N.t),className:"mt-2 underline",children:l.ag._({id:"WslJvd",values:{PERPS_LP_TICKER:N.t}})})]})}),(0,h.jsxs)("div",{className:"flex flex-row justify-between text-xs font-[500] text-white",children:[(0,h.jsx)("p",{children:(0,h.jsx)(o.cC,{id:"Ljs/JP"})}),(0,h.jsxs)("div",{onClick:Ee,className:"flex cursor-pointer flex-row items-center space-x-2 fill-current text-white/25",children:[(0,h.jsx)(O.Z,{width:10,height:10}),(0,h.jsx)(R.Z,{mintAddress:ke.address,decimals:ke.decimals})]})]}),(0,h.jsx)("div",{className:(0,V.cn)("relative rounded-xl bg-v2-background-dark","mt-1 p-2","lg:mt-3 lg:px-3 lg:py-2"),children:(0,h.jsx)(W.Z,{control:xe,pair:ke,pairName:"fromPairValue",onSubmit:Je,mintsList:Ye,modalId:"PERPS_LP_PAIRS_SELECT_FROM_PAIR_MODAL_ID"})}),nt||Fe?(0,h.jsxs)("div",{className:'items-center" relative mt-2 flex w-full flex-col gap-2 rounded-lg border border-jupiter-yellow bg-jupiter-yellow bg-opacity-10 px-4 py-3 text-xs text-jupiter-yellow',children:[nt?(0,h.jsx)("p",{className:"text-xs",children:nt}):null,Fe?(0,h.jsxs)("div",{className:"text-xs",children:[Fe?(0,h.jsx)("p",{children:l.ag._({id:"PwXE5N"})}):null,De?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("p",{children:l.ag._({id:"WEQ5ss"})}),(0,h.jsx)("button",{type:"button",className:"mt-1 underline",onClick:function(){return n("viaSwap")},children:l.ag._({id:"RIQjeJ"})})]}):null]}):null]}):null,(0,h.jsx)(je,{}),[].concat((0,a.Z)(lt),[Ve],(0,a.Z)(ct)).filter(Boolean).length>0&&(0,h.jsx)("div",{className:"mt-2 rounded-lg bg-jupiter-red px-3 py-2 text-xs text-white",children:[].concat((0,a.Z)(lt),[Ve],(0,a.Z)(ct)).filter(Boolean).map((function(e){return(0,h.jsxs)("span",{className:"flex items-center space-x-2",children:[(0,h.jsx)("div",{className:"h-3 w-3",children:(0,h.jsx)(q.Z,{})}),(0,h.jsx)("span",{children:e})]},e)}))}),null!==w&&void 0!==w&&w.adapter.publicKey?(0,h.jsx)("button",{type:"button",className:(0,V.cn)("mt-3 w-full items-center rounded-lg bg-jupiter-navy p-px font-semibold text-white shadow-lg",{"cursor-not-allowed opacity-50":qe}),disabled:qe,onClick:he(ze),children:(0,h.jsx)("div",{className:"flex items-center justify-center rounded-lg bg-black px-8 py-4",children:(0,h.jsx)("span",{className:"text-center",children:Ge})})}):(0,h.jsx)(le.uS,{buttonClassName:"w-full !bg-transparent",overrideContent:(0,h.jsx)(x.Z,{className:"mt-3 w-full",size:"md",children:(0,h.jsx)("span",{children:(0,h.jsx)(o.cC,{id:"CtByM7"})})})}),Ne.fromPairValue&&Ne.toPairValue&&null!==_&&void 0!==_&&_.lpTokenInfo?(0,h.jsx)("div",{className:"mt-4 rounded-lg border border-v2-lily/10 bg-v2-lily/5 p-3",children:(0,h.jsxs)("div",{className:"space-y-2 text-xs",children:[Me&&Ce&&_e?(0,h.jsx)("div",{className:"inline",children:(0,h.jsx)(o.cC,{id:"iK4JLA",values:{0:u.uf.format(Ne.fromPairValue),1:ke.symbol,2:u.uf.format(new d.Z(_e.toString()).div(Math.pow(10,Ce.decimals)).toDP(Ce.decimals).toString()),3:Ce.symbol,feesText:dt},components:{0:(0,h.jsx)("span",{className:"text-white/50"}),1:(0,h.jsx)("span",{className:"text-white/50"}),2:(0,h.jsx)("span",{className:"mx-1"}),3:(0,h.jsx)("span",{className:"text-white/50"})}})}):(0,h.jsx)("div",{children:(0,h.jsx)(o.cC,{id:"ZuTlhZ",values:{0:u.uf.format(Ne.fromPairValue),1:ke.symbol,feesText:dt},components:{0:(0,h.jsx)("span",{className:"text-white/50"}),1:(0,h.jsx)("span",{className:"mx-1"}),2:(0,h.jsx)("span",{className:"text-white/50"})}})}),(0,h.jsx)("div",{children:(0,h.jsx)(o.cC,{id:"htUPv0",values:{0:u.uf.format(Ne.toPairValue),PERPS_LP_TICKER:N.t},components:{0:(0,h.jsx)("span",{className:"text-white/50"})}})}),(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)(me.Z,{value:(0,u.Hd)(Ne.fromPairValue)?Number(Ne.fromPairValue):void 0,isSubmitting:Pe.isSubmitting,lastRefreshTimestamp:it,refresh:function(){Le(),ut()}}),(0,h.jsx)(F.Z,{inputAmount:(0,u.Hd)(Ne.fromPairValue)?D().BigInt(new d.Z(Ne.fromPairValue).mul(Math.pow(10,ke.decimals)).round().toFixed()):D().BigInt(0),outputAmount:D().BigInt(new d.Z(Ne.toPairValue).mul(Math.pow(10,Se.decimals)).round().toFixed()),inputPair:ke,outputPair:_.lpTokenInfo,reversible:!0})]})]})}):null]})]})},Pe=n(59978),Ne=function(e){var t=e.custody,n=e.totalPoolValue,s=(0,P.tc)(),i=s.perpsTokens,o=s.oraclePrices,l=(0,r.useMemo)((function(){return[].concat((0,a.Z)(i.nonStableTokens),(0,a.Z)(i.stableTokens)).find((function(e){return e.address===t.account.mint.toBase58()}))}),[t,i]),c=(0,r.useMemo)((function(){return o&&o[t.account.mint.toString()]}),[t,o]),m=(0,r.useMemo)((function(){if(c){var e=t.account.assets.owned,r=new d.Z(c).mul(e.toString()).div(Math.pow(10,t.account.decimals)).toDP(2),s=r.gt(0)?r.div(n).mul(100).toNearest(.01,d.Z.ROUND_UP).toNumber():0,i=e.gtn(0)&&t.account.assets.locked.gtn(0)?new d.Z(t.account.assets.locked.toString()).div(e.toString()).mul(1e4):new d.Z(0);return{tokenAmount:e,poolValue:r.toNumber(),weightage:Math.min(s,100),utilizationBps:i}}}),[t,c,n]),p=null!==m&&void 0!==m&&m.utilizationBps?"".concat(new d.Z(m.utilizationBps.toString()).div(100).toDP(2),"%"):"",f=(0,r.useMemo)((function(){if(!m||!o||!l)return null;var e=new d.Z(m.tokenAmount.toString()).div(Math.pow(10,t.account.decimals)),n=(0,u.y_)(e);return u.uf.format(e.toString(),n)}),[t,m,o,l]);return(0,h.jsxs)("div",{className:"flex w-full flex-row overflow-hidden",children:[(0,h.jsx)("div",{className:"flex w-full min-w-[150px] flex-row items-center",children:(0,h.jsxs)("div",{className:"flex flex-row items-center space-x-2",children:[(0,h.jsx)("div",{className:"flex !min-h-[24px] !min-w-[24px] items-center",children:(0,h.jsx)(Pe.Z,{info:l,width:24,height:24})}),l?(0,h.jsxs)("div",{className:"space-y-1",children:[(0,h.jsx)("p",{className:"text-sm text-white",children:null===l||void 0===l?void 0:l.symbol}),(0,h.jsx)("p",{className:"text-xs text-white/30",children:null===l||void 0===l?void 0:l.name})]}):(0,h.jsx)(g.O,{className:"!h-10 !w-20"})]})}),(0,h.jsx)("div",{className:"flex w-full min-w-[222px] flex-row items-center justify-center",children:(0,h.jsx)("div",{className:"flex flex-col items-center justify-center p-4",children:m?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("p",{className:"text-xs text-white",children:["$",u.uf.format(m.poolValue)]}),(0,h.jsxs)("p",{className:"text-xs text-white/30",children:[f," ",null===l||void 0===l?void 0:l.symbol]})]}):(0,h.jsx)(g.O,{className:"!h-6 !w-40"})})}),(0,h.jsx)("div",{className:"flex w-full min-w-[186px] flex-row items-center justify-center",children:(0,h.jsx)("div",{children:m?(0,h.jsx)("span",{className:"text-xs text-white/70",children:"".concat((null===m||void 0===m?void 0:m.weightage)||0,"% / ").concat(t.account.targetRatioBps.toNumber()/100,"%")}):(0,h.jsx)(g.O,{className:"!h-6 !w-20"})})}),(0,h.jsx)("div",{className:"flex w-full min-w-[82px] flex-row items-center justify-end",children:p?(0,h.jsx)("span",{className:"w-14 text-center text-xs text-white/70",children:p}):(0,h.jsx)(g.O,{className:"!h-6 !w-12"})})]})},ke=n(795).Buffer,Se=function(e){var t=e.amount,n=e.toPairTokenInfo,s=(0,se.gs)().userMaxFeeInLamports,a=(0,c.Bn)(),o=a.connection,m=a.getTokenInfo,p=(0,P.tc)(),f=p.perpsTokens,x=p.oraclePrices,h=p.slippage,v=p.poolInfo,g=p.viewClient,w=p.custodies,b=(0,r.useState)(D().BigInt(0)),j=b[0],y=b[1],S=(0,r.useState)(D().BigInt(0)),T=S[0],M=S[1],_=(0,r.useMemo)((function(){var e=Object.values(f).flat();return!Boolean(e.find((function(e){return e.address===n.address})))}),[n.address,f]),I=(0,r.useMemo)((function(){if(v&&x)return w.map((function(e){var t=e.account,n=t.mint,r=t.assets,s=t.decimals,i=t.targetRatioBps,a=x&&x[n.toString()];if(!a)return null;var o=new d.Z(a).mul(r.owned.toString()).div(Math.pow(10,s)).toDP(2),l=o.gt(0)?o.div(v.poolAumUsd).mul(100).toNearest(.01,d.Z.ROUND_DOWN).toNumber():0,c=function(){var e=r.owned.sub(r.locked),t=new d.Z(new d.Z(e.toString()).div(Math.pow(10,s))).mul(new d.Z(a).mul(1e6));return new(C())(t.round().toString())}();return{mint:n.toString(),weightage:new d.Z(i.toString()).sub(100*l),availableLiquidity:c}})).filter(Boolean)}),[w,x,v]),V=(0,r.useMemo)((function(){return n.decimals?new(C())(new d.Z(j.toString()).mul(100-h).div(100).toDP(0).toFixed()):new(C())(0)}),[n.decimals,j,h]),L=(0,r.useState)(!0),B=L[0],R=L[1],E=(0,r.useState)([]),O=E[0],K=E[1],F=(0,r.useState)(null),H=F[0],U=F[1],q=(0,r.useState)(null),W=q[0],z=q[1],J=Math.ceil(100*Number(h)),G=(0,re.OO)({amount:j,inputMint:_&&H?new Z.PublicKey(H.address):void 0,outputMint:_&&n?new Z.PublicKey(n.address):void 0,slippageBps:J,maxAccounts:45}),X=G.quoteResponseMeta,$=G.loading,ee=G.error,te=(0,r.useState)((new Date).getTime()),ne=te[0],ie=te[1],ae=(0,r.useCallback)((function(){if(!t||!g||!v||!I||!(0,u.Hd)(t)||!new d.Z(t).greaterThan(0))return y(D().BigInt(0)),void z(null);R(!0);var e=new(C())(new d.Z(t).mul(v.lpPriceInUSD).mul(1e6).round().toString()),r=I.filter((function(t){return t.availableLiquidity.gt(e)}));if(0===r.length)return K([l.ag._({id:"4tNhb9"})]),void R(!1);var s=r.sort((function(e,t){return e.weightage.toNumber()-t.weightage.toNumber()})),i=m(s[0].mint);if(i){U(i);var a=_?w.find((function(e){return e.account.mint.toBase58()===i.address})):w.find((function(e){return e.account.mint.toBase58()===n.address}));a&&g.getRemoveLiquidityAmountAndFee(new(C())(new d.Z(t).mul(Math.pow(10,v.lpTokenInfo.decimals)).toDP(0).toFixed()),a).then((function(e){if(e&&!("code"in e))y(D().BigInt(e.amount)),z(e.feeBps),K([]);else{y(D().BigInt(0)),z(new(C())(0));var t=e&&6003===e.code?l.ag._({id:"QdIt4g"}):null;K([l.ag._({id:"hevP3C",values:{PERPS_LP_TICKER:N.t,reason:t}})])}})).finally((function(){R(!1),ie((new Date).getTime())}))}}),[t,I,w,m,_,v,n.address,g]);(0,r.useEffect)((function(){ae()}),[t,n.address,J]),(0,r.useEffect)((function(){var e;return M(null!==(e=null===X||void 0===X?void 0:X.quoteResponse.outAmount)&&void 0!==e?e:D().BigInt(0))}),[X]);var oe=(0,c.FB)(null===H||void 0===H?void 0:H.address).balanceLamports,le=(0,r.useCallback)(function(){var e=(0,k.Z)(A().mark((function e(t){var r,a,l,c,u,d,m,p,f,x,h,g,w,b,j,y;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.userPublicKey,e.prev=1,X&&H&&null!==v&&void 0!==v&&v.lpMint){e.next=4;break}throw new Error("Invalid quote response");case 4:return e.next=6,(0,Y.c1)(new Z.PublicKey(H.address),r,o);case 6:return l=e.sent,c=(0,i.Z)(l,1),u=c[0],e.next=11,(0,Y.c1)(new Z.PublicKey(n.address),r,o);case 11:return d=e.sent,m=(0,i.Z)(d,1),p=m[0],f={quoteResponse:null===X||void 0===X?void 0:X.original,userPublicKey:r.toBase58(),wrapAndUnwrapSol:Boolean(!1),prioritizationFeeLamports:s,sourceTokenAccount:u,destinationTokenAccount:p,useTokenLedger:!0},e.next=17,fetch("https://quote-api.jup.ag/v6/swap-instructions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});case 17:return e.next=19,e.sent.json().catch(function(){var e=(0,k.Z)(A().mark((function e(t){var n,r,s;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:return n=e.sent,r=n.error,s=n.message,e.abrupt("return",{error:new Y.qw(s,void 0,r)});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 19:if(!("error"in(a=e.sent))){e.next=22;break}throw new Error(a.error.message);case 22:return h=(x=a).tokenLedgerInstruction,g=x.swapInstruction,w=x.addressLookupTableAddresses,b=new Z.TransactionInstruction({programId:new Z.PublicKey(h.programId),keys:h.accounts.map((function(e){return{pubkey:new Z.PublicKey(e.pubkey),isSigner:e.isSigner,isWritable:e.isWritable}})),data:ke.from(h.data,"base64")}),j=new Z.TransactionInstruction({programId:new Z.PublicKey(g.programId),keys:g.accounts.map((function(e){return{pubkey:new Z.PublicKey(e.pubkey),isSigner:e.isSigner,isWritable:e.isWritable}})),data:ke.from(g.data,"base64")}),e.next=27,Q(o,w);case 27:return y=e.sent,e.abrupt("return",{tokenLedgerInstruction:b,swapInstruction:j,addressLookupTableAccounts:y});case 31:throw e.prev=31,e.t0=e.catch(1),e.t0;case 34:case"end":return e.stop()}}),e,null,[[1,31]])})));return function(t){return e.apply(this,arguments)}}(),[H,s,o,null===v||void 0===v?void 0:v.lpMint,X,n.address]),ce=(0,r.useMemo)((function(){return _?B||$:B}),[_,B,$]);(0,r.useEffect)((function(){X&&R(!1)}),[X]);var ue=(0,r.useMemo)((function(){var e;if(I&&0!==(null===I||void 0===I?void 0:I.length)){var t=_?null===H||void 0===H?void 0:H.address:null===n||void 0===n?void 0:n.address,r=Object.values(I).find((function(e){return e.mint===t}));return null!==(e=null===r||void 0===r?void 0:r.availableLiquidity.muln(995).divn(1e3))&&void 0!==e?e:null}}),[I,null===H||void 0===H?void 0:H.address,_,null===n||void 0===n?void 0:n.address]),de=(0,r.useMemo)((function(){if(_&&ee)return l.ag._({id:"pzwWY5"})}),[ee,_]);return{isLoading:ce,quoteResponseMeta:X,basketTokenWithLowestFee:H,isTokenSwapRequired:_,feeBps:W,receiveAmount:_?T:j,minReceiveAmount:V,getSwapIx:le,tokenSwapOriginalBalance:oe,sellTokenAvailableLiquidity:ue,error:O,hasJupiterError:de,lastRefreshTimestamp:ne,refresh:ae}};function Ae(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ze(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,s=function(){};return{s:s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw i}}}}function Ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Te=_()((function(){return n.e(64642).then(n.bind(n,64642))}),{ssr:!1,loadableGenerated:{webpack:function(){return[64642]}}}),Ce=function(e){var t=e.action,n=e.setAction,s=(0,c.Bn)(),m=s.connection,p=s.getTokenInfo,v=s.tokens,w=(0,c.Os)(),b=w.wallet,j=w.signTransaction,S=(0,P.tc)(),T=S.viewClient,M=S.refreshViews,_=S.poolInfo,E=S.oraclePrices,K=S.perpsTokens,z=S.custodies,J=(0,pe.R3)(),G=(0,ue.KO)(ce.yz),Q=(0,i.Z)(G,1)[0],Y=(0,se.gs)().priorityLevel,X=(0,c.C9)(),$=(0,I.cI)({defaultValues:{fromPair:y.Lr.toString(),fromPairValue:"",toPair:"",receiveAmount:"",minReceiveAmount:""}}),ee=$.control,ne=$.handleSubmit,re=$.watch,ie=$.setValue,ae=$.formState,xe=re(),he=(0,r.useMemo)((function(){return(null===_||void 0===_?void 0:_.lpTokenInfo)||y.Zt}),[_]);(0,r.useEffect)((function(){var e;null!==_&&void 0!==_&&_.lpTokenInfo&&ie("fromPair",null===_||void 0===_||null===(e=_.lpTokenInfo)||void 0===e?void 0:e.address.toString())}),[null===_||void 0===_?void 0:_.lpTokenInfo,ie]);var ge=(0,r.useMemo)((function(){return p(xe.toPair)||y.Zt}),[p,xe.toPair]);(0,r.useEffect)((function(){ie("toPair",ge.address)}),[ge,ie]);var we=Se({amount:(0,u.Hd)(xe.fromPairValue)?xe.fromPairValue:"",toPairTokenInfo:ge}),be=we.isLoading,je=we.quoteResponseMeta,ye=we.feeBps,Pe=we.minReceiveAmount,Ne=we.receiveAmount,ke=we.basketTokenWithLowestFee,Ze=we.isTokenSwapRequired,Ce=we.getSwapIx,Me=we.sellTokenAvailableLiquidity,_e=we.hasJupiterError,Ie=we.error,Ve=we.lastRefreshTimestamp,Le=we.refresh,Be=(0,r.useCallback)((function(e){ie("fromPair",e.address.toString()),ie("fromPairValue","")}),[ie]),Re=(0,r.useCallback)((function(e){ie("toPair",e.address.toString()),ie("fromPairValue","")}),[ie]),Ee=(0,c.FB)(xe.fromPair,he.decimals),Oe=Ee.balance,Ke=Ee.balanceLamports,De=(0,r.useCallback)((function(e){e.preventDefault(),ie("fromPairValue",String(Oe))}),[Oe,ie]),Fe=(0,r.useMemo)((function(){return!(0,u.Hd)(xe.fromPairValue)||new d.Z(xe.fromPairValue).gt(Oe)}),[Oe,xe.fromPairValue]),He=(0,c.iG)(),Ue=(0,r.useMemo)((function(){var e,t=null===(e=He.account)||void 0===e?void 0:e.account.lamports;return!t||t<oe.WO}),[He.account]),qe=(0,r.useMemo)((function(){return E?E[ge.address]:null}),[E,ge.address]),We=(0,r.useMemo)((function(){return!!(Me&&Pe&&qe)&&new d.Z(Pe.toString()).div(Math.pow(10,ge.decimals)).mul(qe).mul(1e6).gt(Me.toString())}),[Pe,Me,ge.decimals,qe]);(0,r.useEffect)((function(){var e=[];We&&(e.push(l.ag._({id:"sm1o6w"})),e.push(l.ag._({id:"zSt0kp",values:{0:new d.Z(Me?Me.toString():0).div(1e6).toFixed(2)}}))),$e(e.join("\n"))}),[We,Me]),(0,r.useEffect)((function(){if(!Pe||!xe.fromPairValue||Pe.isZero())return ie("receiveAmount",""),void ie("minReceiveAmount","");ie("receiveAmount",new d.Z(Ne.toString()).div(Math.pow(10,ge.decimals)).toFixed()),ie("minReceiveAmount",new d.Z(Pe.toString()).div(Math.pow(10,ge.decimals)).toFixed())}),[Pe,Ne,ie,ge.decimals,xe.fromPairValue]);var ze=(0,r.useMemo)((function(){return Ue||Fe||ae.isSubmitting||!Pe||We||Boolean(_e)||Ie.length>0}),[Ue,Fe,ae.isSubmitting,Pe,We,_e,Ie]);(0,U.Gl)(be||!Ze||null===je||void 0===je?void 0:je.quoteResponse,(null===ke||void 0===ke?void 0:ke.address)||"",(null===ge||void 0===ge?void 0:ge.address)||"");var Je=(0,H.Z)({selectedRoute:je,hasEnoughSOL:!Ue}).errors,Ge=r.useCallback(function(){var e=(0,k.Z)(A().mark((function e(t){var n,r,s,i,a,o,c,u,p;return A().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.fromPairValue,!ze&&T&&null!==b&&void 0!==b&&b.adapter.publicKey&&n&&_&&j){e.next=3;break}return e.abrupt("return");case 3:if(r=ke?Ze?z.find((function(e){return e.account.mint.toBase58()===ke.address})):z.find((function(e){return e.account.mint.toBase58()===ge.address})):null){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,s=new(C())(new d.Z(n).mul(Math.pow(10,he.decimals)).toDP(0).toFixed()),e.next=10,m.getLatestBlockhash("confirmed");case 10:return i=e.sent,a=i.blockhash,o=i.lastValidBlockHeight,c={lpTokenMint:new Z.PublicKey(_.lpMint),wallet:b,publicKey:b.adapter.publicKey,connection:m,custody:r,payAmount:s,minReceiveAmount:Pe,custodyMetas:T.getCustodyMetas(),shouldCloseLpTokenAccount:s.eq(Ke),getSwapIx:null,blockhash:a},Ze&&(c.minReceiveAmount=new(C())(0),c.getSwapIx=Ce),e.next=17,te(c);case 17:return u=e.sent,e.next=20,J(u,{blockhash:a,lastValidBlockHeight:o,idl:fe.x,idlProgramId:P.KX,skipPreflight:!0},{submittingMessage:l.ag._({id:"tViss/",values:{0:new d.Z(Pe.toString()).div(Math.pow(10,ge.decimals)).toString(),1:ge.symbol,fromPairValue:n,PERPS_LP_TICKER:N.t}}),successMessage:l.ag._({id:"Li4DX1",values:{0:he.symbol,fromPairValue:n}}),errorMessage:l.ag._({id:"3T/hk3",values:{PERPS_LP_TICKER:N.t}}),referenceFee:"MEDIUM"===Y?Q.perps.m:"HIGH"===Y?Q.perps.h:"VERY_HIGH"===Y?Q.perps.vh:void 0,minimumFee:ce.uo,requestComputeBudgetLimit:5e5});case 20:if(!("error"in(p=e.sent))){e.next=23;break}throw p.error;case 23:ie("fromPairValue",""),e.next=29;break;case 26:e.prev=26,e.t0=e.catch(6),console.error("Failed to sell into LP pool",e.t0);case 29:return e.prev=29,X(),M(),e.finish(29);case 33:case"end":return e.stop()}}),e,null,[[6,26,29,33]])})));return function(t){return e.apply(this,arguments)}}(),[ze,T,b,_,j,ke,Ze,z,ge.address,ge.decimals,ge.symbol,he.decimals,he.symbol,m,Pe,Ke,J,ie,Ce,Y,Q.perps.m,Q.perps.h,Q.perps.vh,X,M]),Qe=r.useMemo((function(){if(xe.fromPairValue){if(Fe||Ue)return l.ag._({id:"UsQ5AM",values:{0:Ue?"SOL":he.symbol}});if(ae.isSubmitting)return(0,h.jsxs)("span",{className:"flex items-center justify-center",children:[(0,h.jsx)(B.Z,{className:"!h-4 !w-4",baseColor:"white",spinnerColor:"black"}),(0,h.jsx)("div",{className:"mr-2"}),l.ag._({id:"5IbE9j",values:{PERPS_LP_TICKER:N.t}})]})}return(0,h.jsx)(L.Z,{children:(0,h.jsx)(o.cC,{id:"xNB0TS"})})}),[ae.isSubmitting,he,Fe,Ue,xe.fromPairValue]),Ye=(0,r.useState)(""),Xe=Ye[0],$e=Ye[1],et=(0,r.useMemo)((function(){return ye&&xe.fromPairValue&&Pe?"".concat(new d.Z(ye.toString()).div(100).toString(),"%"):""}),[ye,Pe,xe.fromPairValue]),tt=(0,r.useMemo)((function(){var e;return Boolean(null===b||void 0===b||null===(e=b.adapter.supportedTransactionVersions)||void 0===e?void 0:e.has(0))}),[null===b||void 0===b?void 0:b.adapter.supportedTransactionVersions]),nt=(0,r.useMemo)((function(){if(null!==b&&void 0!==b&&b.adapter.connected&&!tt)return[].concat((0,a.Z)(K.nonStableTokens),(0,a.Z)(K.stableTokens)).map((function(e){return e.address}));var e,t=[],n=Ae(v);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.address!==(null===_||void 0===_?void 0:_.lpTokenInfo.address)&&t.push(r.address)}}catch(s){n.e(s)}finally{n.f()}return t}),[K.nonStableTokens,K.stableTokens,null===_||void 0===_?void 0:_.lpTokenInfo.address,v,tt,null===b||void 0===b?void 0:b.adapter.connected]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(ve,{action:t,setAction:n,refresh:Le,isLoading:be}),(0,h.jsxs)("div",{className:"px-4 pb-5 pt-2",children:[(0,h.jsx)(de.Z,{iconSize:12,className:"mb-2 rounded-lg bg-v2-lily/10 !p-2 !text-v2-lily",message:(0,h.jsxs)("div",{className:"flex flex-col",children:[(0,h.jsx)("span",{children:l.ag._({id:"SHnvMH"})}),(0,h.jsx)(f(),{href:"/limit/".concat(N.t,"-USDC"),className:"mt-2 underline",children:l.ag._({id:"WslJvd",values:{PERPS_LP_TICKER:N.t}})})]})}),(0,h.jsxs)("div",{className:"flex flex-row justify-between text-xs font-[500] text-white",children:[(0,h.jsx)("p",{children:(0,h.jsx)(o.cC,{id:"Ljs/JP"})}),(0,h.jsxs)("div",{onClick:De,className:"flex cursor-pointer flex-row items-center space-x-2 fill-current text-white/25",children:[(0,h.jsx)(O.Z,{width:10,height:10}),(0,h.jsx)(R.Z,{mintAddress:he.address,decimals:he.decimals})]})]}),(0,h.jsx)("div",{className:(0,V.cn)("relative rounded-xl bg-v2-background-dark","mt-1 p-2 py-3","lg:mt-3 lg:p-4"),children:(0,h.jsx)(W.Z,{control:ee,pair:he,pairName:"fromPairValue",onSubmit:Be,hideUSDValue:!0,disableTokenSelect:!0,mintsList:[],modalId:"PERPS_LP_PAIRS_SELECT_FROM_PAIR_MODAL_ID"})}),(0,h.jsxs)("div",{className:"mt-8 flex flex-row justify-between text-xs font-[500] text-white",children:[(0,h.jsx)("p",{children:(0,h.jsx)(o.cC,{id:"CrN11x"})}),(0,h.jsxs)("div",{className:"flex flex-row items-center space-x-2 fill-current text-white/25",children:[(0,h.jsx)(O.Z,{width:10,height:10}),(0,h.jsx)(R.Z,{mintAddress:ge.address,decimals:ge.decimals})]})]}),(0,h.jsxs)("div",{className:(0,V.cn)("relative rounded-xl bg-v2-background-dark","mt-1 p-2","lg:mt-3 lg:px-3 lg:py-2"),children:[(0,h.jsx)(W.Z,{disabled:!0,control:ee,pair:ge,pairName:"receiveAmount",onSubmit:Re,mintsList:nt,modalId:"PERPS_LP_PAIRS_SELECT_TO_PAIR_MODAL_ID"}),(0,u.Hd)(xe.fromPairValue)&&be?(0,h.jsx)(g.O,{className:"absolute right-2 top-2 !h-10 !w-[calc(100%-140px)]"}):null]}),Xe?(0,h.jsx)("div",{className:'items-center" relative mt-2 flex w-full flex-row space-x-2 rounded-lg border border-jupiter-yellow bg-jupiter-yellow bg-opacity-10 px-4 py-3 text-xs text-jupiter-yellow',children:(0,h.jsx)("div",{className:"whitespace-pre-line text-xs",children:Xe})}):null,(0,h.jsx)(Te,{}),[].concat((0,a.Z)(Je),[_e],(0,a.Z)(Ie)).filter(Boolean).length>0&&(0,h.jsx)("div",{className:"mt-2 rounded-lg bg-jupiter-red px-3 py-2 text-xs text-white",children:[].concat((0,a.Z)(Je),[_e],(0,a.Z)(Ie)).filter(Boolean).map((function(e){return(0,h.jsxs)("span",{className:"flex items-center space-x-2",children:[(0,h.jsx)("div",{className:"h-3 w-3",children:(0,h.jsx)(q.Z,{})}),(0,h.jsx)("span",{children:e})]},e)}))}),null!==b&&void 0!==b&&b.adapter.publicKey?(0,h.jsx)("button",{type:"button",className:(0,V.cn)("mt-3 w-full items-center rounded-lg bg-jupiter-navy p-px font-semibold text-white shadow-lg",{"cursor-not-allowed opacity-50":ze}),disabled:ze,onClick:ne(Ge),children:(0,h.jsx)("div",{className:"flex items-center justify-center rounded-lg bg-black px-8 py-4",children:(0,h.jsx)("span",{className:"text-center",children:Qe})})}):(0,h.jsx)(le.uS,{buttonClassName:"w-full !bg-transparent",overrideContent:(0,h.jsx)(x.Z,{className:"mt-3 w-full",size:"md",children:(0,h.jsx)("span",{children:(0,h.jsx)(o.cC,{id:"CtByM7"})})})}),xe.fromPairValue&&Ne&&null!==_&&void 0!==_&&_.lpTokenInfo?(0,h.jsx)("div",{className:"mt-4 rounded-lg border border-v2-lily/10 bg-v2-lily/5 p-3",children:(0,h.jsxs)("div",{className:"space-y-2 text-xs",children:[Ze&&ke?(0,h.jsx)("div",{className:"inline",children:(0,h.jsx)(o.cC,{id:"HBp72M",values:{0:u.uf.format(xe.fromPairValue),1:he.symbol,2:ke.symbol,3:u.uf.format(new d.Z(Ne.toString()).div(Math.pow(10,ge.decimals)).toDP(ge.decimals).toString()),4:ge.symbol,feesText:et},components:{0:(0,h.jsx)("span",{className:"text-white/50"}),1:(0,h.jsx)("span",{className:"text-white/50"}),2:(0,h.jsx)("span",{className:"mx-1"}),3:(0,h.jsx)("span",{className:"text-white/50"}),4:(0,h.jsx)("span",{className:"text-white/50"}),5:(0,h.jsx)("span",{className:"text-white/50"})}})}):(0,h.jsx)("div",{children:(0,h.jsx)(o.cC,{id:"FvXLUA",values:{0:xe.fromPairValue,1:he.symbol,feesText:et},components:{0:(0,h.jsx)("span",{className:"text-white/50"}),1:(0,h.jsx)("span",{className:"mx-1"}),2:(0,h.jsx)("span",{className:"text-white/50"})}})}),(0,h.jsx)("div",{children:(0,h.jsx)(o.cC,{id:"a6PJmK",values:{0:new d.Z(Ne.toString()).div(Math.pow(10,ge.decimals)).toString(),1:ge.symbol},components:{0:(0,h.jsx)("span",{className:"text-white/50"})}})}),(0,h.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,h.jsx)(me.Z,{value:(0,u.Hd)(xe.fromPairValue)?Number(xe.fromPairValue):void 0,isSubmitting:ae.isSubmitting,lastRefreshTimestamp:Ve,refresh:Le}),(0,h.jsx)(F.Z,{inputAmount:(0,u.Hd)(xe.fromPairValue)?D().BigInt(new d.Z(xe.fromPairValue).mul(Math.pow(10,he.decimals)).round().toFixed()):D().BigInt(0),outputAmount:D().BigInt(new d.Z(Ne.toString()).round().toFixed()),inputPair:he,outputPair:ge,reversible:!0})]})]})}):null]})]})},Me=function(){var e=(0,c.Os)().publicKey,t=(0,P.tc)(),n=t.custodies,s=t.poolInfo,p=t.oraclePrices,k=t.perpsTokens,S=(0,c.gZ)().fetchTokenAccounts,A=(0,c.FB)(null===s||void 0===s?void 0:s.lpTokenInfo.address,null===s||void 0===s?void 0:s.lpTokenInfo.decimals);(0,r.useEffect)((function(){null!==s&&void 0!==s&&s.lpMint&&S([null===s||void 0===s?void 0:s.lpMint])}),[s,S]);var Z=(0,r.useMemo)((function(){return p&&n?n.reduce((function(e,t){var n,r=t.account.assets.owned,s=null!==(n=p[t.account.mint.toString()])&&void 0!==n?n:new d.Z(0),i=new d.Z(s).mul(r.toString()).div(Math.pow(10,t.account.decimals)).toDP(2);return e.add(i)}),new d.Z(0)):new d.Z(0)}),[n,p]),T=(0,r.useMemo)((function(){return null!==s&&void 0!==s&&s.poolApr.lastUpdated?new Date(null===s||void 0===s?void 0:s.poolApr.lastUpdated.muln(1e3).toNumber()).toLocaleDateString():null}),[null===s||void 0===s?void 0:s.poolApr.lastUpdated]),C=ge(),M=C.availableAUMQuotas,_=C.totalAUMQuotas,I=(0,r.useMemo)((function(){return[].concat((0,a.Z)(k.nonStableTokens),(0,a.Z)(k.stableTokens))}),[k]),V=r.useState("APY"),L=(0,i.Z)(V,2),B=L[0],R=L[1],E=(0,r.useCallback)((function(){R((function(e){return"APR"===e?"APY":"APR"}))}),[]),O=(0,r.useMemo)((function(){if(null===s||void 0===s||!s.poolApr.feeAprBps)return"";var e=new d.Z(s.poolApr.feeAprBps.toString()).div(100),t="APR"===B?e:(0,u.bK)(e);return"".concat(t.toFixed(2),"%")}),[B,null===s||void 0===s?void 0:s.poolApr.feeAprBps]),K=(0,r.useMemo)((function(){return"JLP Earn ".concat(O)}),[O]),D=(0,r.useState)("viaSwap"),F=D[0],H=D[1];return(0,h.jsxs)("div",{className:"w-full justify-center p-4 lg:flex",children:[(0,h.jsx)(m.PB,{title:K}),(0,h.jsxs)("div",{className:"block w-full max-w-7xl gap-2 pb-4 lg:flex lg:gap-6 lg:px-4",children:[(0,h.jsxs)("div",{className:"hideScrollbar w-full overflow-x-scroll",children:[(0,h.jsxs)("div",{className:"justify-between rounded-lg border border-labs/10 bg-labs/5 p-4 lg:flex lg:px-6 lg:py-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{className:"text-[30px] font-semibold leading-none text-labs",children:(0,h.jsx)("h1",{children:l.ag._({id:"UyGPO5",values:{PERPS_LP_TICKER:N.t}})})}),(0,h.jsxs)("p",{className:"mt-2 text-xs text-labs/75",children:[(0,h.jsx)("span",{className:"font-bold",children:(0,h.jsx)(o.cC,{id:"J2Tr1a",values:{PERPS_LP_TICKER:N.t}})})," ",(0,h.jsx)("span",{children:l.ag._({id:"NaeDfM"})})]}),(0,h.jsxs)("p",{className:"mt-2 text-xs text-labs/75",children:[(0,h.jsx)("span",{className:"font-bold",children:(0,h.jsx)(o.cC,{id:"TCx5S5",values:{PERPS_LP_TICKER:N.t}})})," ",(0,h.jsx)("span",{children:l.ag._({id:"sGB6AK"})})]}),(0,h.jsx)("div",{className:"mt-1 flex flex-col",children:(0,h.jsxs)("ul",{className:"w-full list-outside list-disc space-y-1.5 px-3 text-xs text-labs/75",children:[(0,h.jsxs)("li",{className:"list-outside",children:[l.ag._({id:"iJaH+W"})," ",(0,h.jsx)("span",{children:I.map((function(e){return e.symbol})).join(", ")}),"."]}),(0,h.jsx)("li",{className:"list-outside",children:l.ag._({id:"d9U9Nn"})}),(0,h.jsx)("li",{className:"list-outside",children:l.ag._({id:"dWO0yD"})})]})}),(0,h.jsxs)("p",{className:"mt-2 text-xs text-labs/75",children:[(0,h.jsx)("span",{className:"font-bold",children:l.ag._({id:"u3cJ2E"})}),(0,h.jsx)("span",{children:l.ag._({id:"tMDY7V"})})]}),(0,h.jsxs)(f(),{href:y.eS,target:"_blank",className:"mt-2 flex items-center space-x-1 fill-current text-xs text-labs/75",children:[(0,h.jsx)("p",{className:"text-xs font-bold",children:l.ag._({id:"zwWKhA"})}),(0,h.jsx)(b.Z,{})]})]}),(0,h.jsxs)("div",{className:"mt-8 min-w-[120px] lg:mt-0 lg:text-end",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-1 fill-current text-sm font-semibold text-labs/75 lg:justify-end",children:[(0,h.jsx)("span",{children:"APY"===B?l.ag._({id:"rSayea"}):l.ag._({id:"70wH1Q"})}),(0,h.jsx)(w.Z,{content:(0,h.jsxs)("div",{className:"flex flex-col space-y-2 !text-left",children:[(0,h.jsx)("p",{children:l.ag._({id:"HF/BGj"})}),(0,h.jsx)("p",{children:l.ag._({id:"rPI7vI"})})]}),children:(0,h.jsx)(j.Z,{width:16,height:16})})]}),O?(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(w.Z,{content:l.ag._({id:"jSKqBd"}),children:(0,h.jsx)("p",{onClick:E,className:"mt-2 cursor-pointer text-xl font-semibold leading-none text-labs",children:O})})}):(0,h.jsx)(g.O,{className:"!h-7 !w-20"}),(0,h.jsx)("p",{className:"mt-1 text-xs text-v2-lily/30",children:l.ag._({id:"JUfe/L",values:{lastUpdatedAtText:T}})})]})]}),(0,h.jsxs)("div",{className:"relative mt-3 w-full overflow-hidden rounded-xl border border-white/5 bg-white/[0.03] py-6",children:[(0,h.jsx)("p",{className:"px-5 text-sm text-white/50",children:l.ag._({id:"xkbKnz"})}),(0,h.jsx)("div",{className:"mb-6 mt-3 px-5",children:s?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("p",{className:"text-3xl font-semibold",children:["$",u.uf.format(s.poolAumUsd.toDP(2).toNumber())]}),(0,h.jsxs)("div",{className:"mt-1 flex space-x-1 fill-current text-xs text-v2-lily/50",children:[(0,h.jsx)("span",{className:"",children:l.ag._({id:"MocL75"})}),(0,h.jsxs)("span",{children:["$",u.uf.format(_.toDP(2).toNumber())]}),(0,h.jsx)(w.Z,{content:(0,h.jsxs)("div",{className:"flex flex-col space-y-1 !text-left",children:[(0,h.jsx)("p",{children:l.ag._({id:"Xu9RJQ",values:{0:u.uf.format(_.toDP(2).toNumber())}})}),(0,h.jsx)("p",{className:"text-v2-lily/50",children:l.ag._({id:"2ES9Jp",values:{0:u.uf.format(d.Z.max(M,0).toDP(2).toNumber())}})})]}),children:(0,h.jsx)(j.Z,{width:16,height:16})})]})]}):(0,h.jsx)(g.O,{className:"!h-9 !w-40"})}),(0,h.jsx)("div",{className:"border-t border-white/5",children:(0,h.jsx)("p",{className:"p-4 text-sm text-white/50",children:l.ag._({id:"NEVrIh"})})}),(0,h.jsx)("div",{className:"hideScrollbar overflow-x-auto",children:(0,h.jsxs)(v,{background:"rgba(35,48,60)",shadow:"rgba(255,255,255,0.2)",children:[(0,h.jsxs)("div",{className:"flex flex-row items-center justify-between px-6",children:[(0,h.jsx)("div",{className:"w-full min-w-[150px]",children:(0,h.jsx)("span",{className:"text-xs text-white/25",children:l.ag._({id:"TP9/K5"})})}),(0,h.jsx)("div",{className:"flex w-full min-w-[222px] justify-center",children:(0,h.jsx)("span",{className:"text-xs text-white/25",children:l.ag._({id:"2VjpLJ"})})}),(0,h.jsx)("div",{className:"w-full min-w-[186px]",children:(0,h.jsxs)("span",{className:"flex items-center justify-center space-x-1 fill-current text-center text-xs text-white/25",children:[(0,h.jsx)("span",{children:l.ag._({id:"L4PU7Z"})}),(0,h.jsx)(w.Z,{content:l.ag._({id:"3xsx0e"}),children:(0,h.jsx)(j.Z,{width:16,height:16})})]})}),(0,h.jsx)("div",{className:"w-full min-w-[82px] text-end",children:(0,h.jsx)("span",{className:"text-xs text-white/25",children:l.ag._({id:"APvW6L"})})})]}),(0,h.jsx)("div",{className:"flex w-full flex-col justify-between",children:n.length>0?n.map((function(e,t){return(0,h.jsx)("div",{className:"w-full min-w-[688px] px-6",children:(0,h.jsx)("div",{className:"border-b border-b-white/5",children:(0,h.jsx)(Ne,{custody:e,totalPoolValue:Z})})},t)})):Array(4).fill(void 0).map((function(e,t){return(0,h.jsx)("div",{className:"px-6",children:(0,h.jsx)("div",{className:"border-b border-b-white/5",children:(0,h.jsx)(g.O,{className:"!h-[64px]"},t)})},t)}))})]})}),(0,h.jsxs)("div",{className:"mt-6 space-y-3 px-6",children:[(0,h.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,h.jsx)("div",{className:"flex items-center space-x-1 fill-current text-xs text-v2-lily",children:(0,h.jsx)("p",{className:"text-xs text-white/50",children:l.ag._({id:"2ktTGK",values:{PERPS_LP_TICKER:N.t}})})}),s?(0,h.jsxs)("span",{className:"text-xs",children:["$",s.lpPriceInUSD.toDP(3).toNumber()]}):(0,h.jsx)(g.O,{className:"!h-4 !w-20"})]}),(0,h.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,h.jsx)("p",{className:"text-xs text-white/50",children:l.ag._({id:"pzO3Xa"})}),s?(0,h.jsxs)("p",{className:"text-xs",children:[u.uf.format(s.lpTokenSupply.toDP(3).toNumber())," ",N.t]}):(0,h.jsx)(g.O,{className:"!h-4 !w-20"})]})]})]})]}),(0,h.jsxs)("div",{className:"mt-4 w-full lg:mt-0 lg:w-[360px] lg:min-w-[360px] lg:max-w-[360px]",children:[(0,h.jsxs)("div",{className:"flex flex-col justify-between rounded-xl bg-v2-background",children:[e?(0,h.jsxs)("div",{className:"border-b border-b-white/5 px-5 py-6",children:[(0,h.jsx)("span",{className:"text-sm text-white/50",children:l.ag._({id:"1tCyPy"})}),(0,h.jsx)("div",{children:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("p",{className:"text-2xl font-semibold",children:[u.uf.format(A.balance)," ",N.t]}),(0,h.jsxs)("p",{className:"text-xs text-white/50",children:["~ $",s?u.uf.format(new d.Z(A.balance).mul(s.lpPriceInUSD).toDP(3).toNumber()):0]})]})})]}):null,(0,h.jsx)("div",{className:"flex flex-col justify-center",children:"viaSwap"===F?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(ve,{action:F,setAction:H,isLoading:!1}),(0,h.jsxs)("div",{className:"flex flex-col p-4",children:[(0,h.jsx)("p",{className:"mt-2 text-xs text-v2-lily/50",children:l.ag._({id:"d118lB",values:{PERPS_LP_TICKER:N.t}})}),(0,h.jsx)(f(),{shallow:!0,href:"/swap/USDC-".concat(N.t),className:"mt-4",children:(0,h.jsx)(x.Z,{size:"sm",children:(0,h.jsx)("span",{className:"text-base",children:l.ag._({id:"xCtEBz",values:{PERPS_LP_TICKER:N.t}})})})})]})]}):"buy"===F?(0,h.jsx)(ye,{action:F,setAction:H}):(0,h.jsx)(Ce,{action:F,setAction:H})})]}),(0,h.jsx)("div",{className:"pb-20"})]})]})]})},_e=!0,Ie=function(){return(0,h.jsx)(s.Z,{children:(0,h.jsx)(Me,{})})}},64808:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/perps-earn",function(){return n(82875)}])}},function(e){e.O(0,[13215,69711,7842,59536,8524,49774,92888,40179],(function(){return t=64808,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=perps-earn-f49414cf67dcb563.js.map