"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7842],{36872:function(e,t,n){n(93981);var r=n(24201),s=n(29541);t.Z=function(e){var t=e.className,n=e.width,o=void 0===n?20:n,a=e.height,i=void 0===a?20:a;return(0,s.jsx)("div",{className:(0,r.cn)("flex items-center justify-center rounded-full",t),style:{width:o,height:i},children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 200 200",children:[(0,s.jsxs)("radialGradient",{id:"a10",cx:".66",fx:".66",cy:".3125",fy:".3125",gradientTransform:"scale(1.5)",children:[(0,s.jsx)("stop",{offset:"0",stopColor:"#00BCF0"}),(0,s.jsx)("stop",{offset:".3",stopColor:"#00BCF0",stopOpacity:".9"}),(0,s.jsx)("stop",{offset:".6",stopColor:"#00BCF0",stopOpacity:".6"}),(0,s.jsx)("stop",{offset:".8",stopColor:"#00BCF0",stopOpacity:".3"}),(0,s.jsx)("stop",{offset:"1",stopColor:"#00BCF0",stopOpacity:"0"})]}),(0,s.jsx)("circle",{"transform-origin":"center",fill:"none",stroke:"url(#a10)",strokeWidth:"24",strokeLinecap:"round",strokeDasharray:"200 1000",strokeDashoffset:"0",cx:"100",cy:"100",r:"70",children:(0,s.jsx)("animateTransform",{type:"rotate",attributeName:"transform",calcMode:"spline",dur:"2",values:"360;0",keyTimes:"0;1",keySplines:"0 0 1 1",repeatCount:"indefinite"})}),(0,s.jsx)("circle",{"transform-origin":"center",fill:"none",opacity:".2",stroke:"#00BCF0",strokeWidth:"24",strokeLinecap:"round",cx:"100",cy:"100",r:"70"})]})})}},39860:function(e,t,n){n.d(t,{A:function(){return i}});var r=n(27195),s=n(8857),o=n.n(s),a=n(45009);function i(){return(0,a.a)(["lst-apy"],(0,r.Z)(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://worker.jup.ag/lst-apys");case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)}))),{retry:3,keepPreviousData:!0,staleTime:3e5})}},7842:function(e,t,n){n.d(t,{ZP:function(){return q},au:function(){return V}});var r=n(63956),s=n(27195),o=n(70107),a=n(8857),i=n.n(a),u=n(8473),c=n(4707),l=n(93981),d=n(19240),f=n(14218),p=n(24201),m=n(72215),h=n(50882),v=n(25546),x=function(e){var t,n=e.items,r=e.defaultIndex,s=void 0===r?0:r,o=e.key,a=e.autoPaginateContainerId,i=void 0===a?"":a,u=(0,l.useState)(-1),c=u[0],d=u[1],f=(0,l.useRef)([]),p=(null===(t=document.getElementById(i))||void 0===t?void 0:t.getBoundingClientRect())||0,m=(0,l.useState)(!1),h=m[0],x=m[1];(0,l.useEffect)((function(){n.length>0&&setTimeout((function(){d(s)}),100)}),[o||n]);var y=(0,l.useCallback)((function(e){("ArrowUp"===e.code||"Tab"===e.code&&!0===e.shiftKey)&&(e.preventDefault(),x(!0),d((function(e){if(e>0){var t;if(i&&f.current[c]&&null!==(t=f.current[c].current)&&void 0!==t&&t.scrollIntoView){var n=f.current[e-1].current.offsetTop;n+50<p.height&&(document.getElementById("search-result-list").scrollTop=n-p.top)}return e-1}return-1}))),("ArrowDown"===e.code||"Tab"===e.code&&!0!==e.shiftKey)&&(e.preventDefault(),x(!0),d((function(e){if(e>=-1&&e<n.length-1){var t;if(i&&f.current[c]&&null!==(t=f.current[c].current)&&void 0!==t&&t.scrollIntoView){var r=f.current[e+1].current.offsetTop;r+50>p.height&&(document.getElementById("search-result-list").scrollTop=r)}return e+1}return e})))}),[c,n,i,p.height,p.top]);(0,v._1)("keydown",y);var g=(0,l.useCallback)((function(e){d(e),x(!1)}),[d]);return{itemsRef:f,keyboardIndex:c,setFocusIndex:g,isKeyboard:h}},y=n(59978),g=n(11261),b=n(25224),k=n(13838),w=n(13170),j=n(40558),C=n(7744),T=n(57987),B=n(91348),I=n.n(B),M=n(85948),S=n(11421),Z=n(70006),O=n(36872),_=n(39860),E=n(29541);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=52,D=109,F=function(e){var t=[P,D,e*g.x,8].reduce((function(e,t){return e+t}),0);return Math.min(window.innerHeight-32,t)},L=(0,l.memo)((function(e){var t=e.data,n=e.index,r=e.style,s=t.searchResult[n],o=s.address===w.RD;return(0,E.jsx)(g.Z,{item:s,index:n,style:r,onSubmit:t.onSubmit,keyboardRefs:t.itemsRef,isKeyboardFocused:n===t.keyboardIndex,onMouseEnter:function(){t.setFocusIndex(n)},suppressCloseModal:t.suppressCloseModal,usdValue:t.mintToUsdValue.get(s.address),isLST:o,apy:t.apy},s.address)}),f.wy),R=function(e){var t=e.tokenInfo,n=e.onClick,r=e.mintsList,s=e.miniMode,o=(0,l.useMemo)((function(){return!r.find((function(e){return t.address===e}))}),[t,r]);return o&&(j.Z,o&&u.cC,(0,p.cn)("flex items-center gap-x-2 rounded-full border border-v2-lily/5 px-2 py-1 font-semibold hover:bg-v2-lily/10",{"cursor-not-allowed opacity-30":o}),y.Z,!1===s&&t.symbol),(0,E.jsxs)("button",{type:"button",onClick:n,className:(0,p.cn)("flex items-center gap-x-2 rounded-full border border-v2-lily/5 px-2 py-1 font-semibold hover:bg-v2-lily/10"),translate:"no",children:[(0,E.jsx)(y.Z,{width:24,height:24,info:t}),!1===s&&(0,E.jsx)("span",{className:"text-xxs",children:t.symbol})]})},V=function(){var e=(0,m.Bn)().getTokenInfo,t=(0,m.gZ)(),n=t.userAccounts,r=t.nativeAccount,o=t.isFetching,a=(0,m.y6)().tokenPriceMap,u=(0,m.jB)().useWSol,c=(0,l.useRef)(new Map),d=(0,l.useRef)(new Map);(0,l.useEffect)((function(){if(n.filter((function(e){return e.info.amount.gtn(0)})).forEach((function(t){var n,s=t.info.mint.toString(),o=e(s);if(o){var i=(0,v.lt)(t.info.amount,o.decimals);s===w.W4.toBase58()&&!u&&r&&(i+=(0,v.lt)(r.info.amount,o.decimals)),c.current.set(t.info.mint.toString(),i);var l=null===(n=a[s])||void 0===n?void 0:n.usd;if(l){var f=new k.Z(i).mul(l);f.greaterThan(0)&&d.current.set(s,f)}}}),new Map),!u&&r){var t,s=(0,v.lt)(r.info.amount,9);c.current.set(w.W4.toBase58(),s);var o=null===(t=a[w.W4.toBase58()])||void 0===t?void 0:t.usd;if(o){var i=new k.Z(s).mul(o);i.greaterThan(0)&&d.current.set(w.W4.toBase58(),i)}}}),[e,r,a,u,n,o]);var f=(0,l.useCallback)(function(){var e=(0,s.Z)(i().mark((function e(t){var n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(){var e=new Map;return t.forEach((function(t){e.has(t.address)||e.set(t.address,t)})),Array.from(e.values())}(),r=n.sort((function(e,t){var n=d.current.get(e.address),r=d.current.get(t.address);if(n&&r)return r.cmp(n);if(n&&!r)return-1;if(!n&&r)return 1;var s=c.current.get(e.address),o=c.current.get(t.address);if(s&&o)return new k.Z(o).cmp(s);if(s&&!o)return-1;if(!s&&o)return 1;var a=0,i=0,u=e.daily_volume||0,l=t.daily_volume||0;return u>l&&(a+=1),l>u&&(i+=1),(0,b.tr)(e)&&(a-=2),(0,b.tr)(t)&&(i-=2),i-a})),e.abrupt("return",r);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return{sortTokenListByBalance:f,mintToUsdValue:d.current}},W=[w.W4.toString(),w.cq.toString(),w.IL.toString()],q=function(e){var t=e.onSubmit,n=e.mintsList,r=e.onClose,a=e.suppressCloseModal,v=e.customStyle,y=e.bestTokens,k=(0,m.gZ)(),w=k.fetchAllAccounts,j=k.isInitialLoading,B=(0,m.Bn)(),N=B.tokenMap,D=B.unknownTokenMap,q=B.topTokenByVolume,K=B.connection,U=B.typesenseInstantsearchAdapter,z=B.addUnknownTokenInfo,G=(0,_.A)().data;(0,l.useEffect)((function(){w()}),[]);var H=(0,Z.JT)().closeModal,J=(0,T.D)(function(){var e=(0,s.Z)(i().mark((function e(t){var n,r,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(){try{return Boolean(new C.PublicKey(t))}catch(e){return!1}}(),e.next=3,U.typesenseClient.multiSearch.perform({searches:n||t.length>30?[{collection:"tokens",q:t,query_by:"address",filter_by:"address:".concat(t),per_page:50}]:[{collection:"tokens",q:"".concat(t),query_by:"symbol,name",sort_by:m.mb.sort_by,filter_by:"tags:=verified",per_page:50},{collection:"tokens",q:t,query_by:"symbol,name,address",sort_by:m.mb.sort_by,per_page:50}]});case 3:if((r=e.sent).results[0]&&!("error"in r.results[0])){e.next=6;break}return e.abrupt("return",[]);case 6:return s=new Map,r.results.map((function(e){return"error"in e||!e.hits?null:e.hits.map((function(e){return e.document}))})).filter(Boolean).flat().forEach((function(e){e&&!s.has(e.address)&&s.set(e.address,e)})),e.abrupt("return",Array.from(s.values()));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Q=J.mutateAsync,X=J.isLoading,Y=V(),$=Y.sortTokenListByBalance,ee=Y.mintToUsdValue,te=(0,l.useState)([]),ne=te[0],re=te[1],se=(0,l.useCallback)(I()(function(){var e=(0,s.Z)(i().mark((function e(t){var n,r,s,a,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t&&!(t.length<=2)){e.next=8;break}return e.t0=re,e.next=5,$([].concat((0,o.Z)(N.values()),(0,o.Z)(D.values())));case 5:return e.t1=e.sent,(0,e.t0)(e.t1),e.abrupt("return");case 8:if(!(n=N.get(t))){e.next=12;break}return re([n]),e.abrupt("return");case 12:return e.next=14,Q(t);case 14:if(!((r=e.sent).length>0)){e.next=24;break}return s=r.map((function(e){return A(A({},e),{},{name:(0,b.a4)(e.name),symbol:(0,b.cv)(e.symbol)})})),e.t2=re,e.next=20,$(s);case 20:return e.t3=e.sent,(0,e.t2)(e.t3),s.forEach((function(e){return z(e)})),e.abrupt("return");case 24:return e.next=26,(0,b.zL)(K,[t]);case 26:a=e.sent,(u=a.get(t))&&(re((function(e){var t=new Map;return t.set(u.address,u),e.forEach((function(e){return t.set(e.address,e)})),Array.from(t.values())})),z(u)),e.next=35;break;case 31:e.prev=31,e.t4=e.catch(0),console.log(e.t4),(0,S.Kz)(M.U7,{error:String(e.t4)});case 35:case"end":return e.stop()}}),e,null,[[0,31]])})));return function(t){return e.apply(this,arguments)}}(),200),[]),oe=(0,l.useCallback)((function(e){re([]),se(e.target.value)}),[se]),ae=x({items:ne||[],defaultIndex:0,key:ne.toString()}),ie=ae.itemsRef,ue=ae.keyboardIndex,ce=ae.setFocusIndex,le=ae.isKeyboard,de=(0,l.createRef)();(0,l.useEffect)((function(){var e;!0===le&&(null===de||void 0===de||null===(e=de.current)||void 0===e||e.scrollToItem(ue))}),[le,ue,de]),(0,l.useEffect)((function(){se("")}),[se]);var fe=(0,b.Gc)(),pe=(0,l.useMemo)((function(){var e=Math.ceil(window.innerHeight/g.x-5);return Math.max(4,Math.min(e,10))}),[fe]);return(0,E.jsxs)("div",{className:"relative flex h-full w-full flex-col overflow-hidden rounded-lg bg-v2-background text-left",style:A({height:F(pe),width:"90vw",maxWidth:448},v),children:[(0,E.jsxs)("div",{className:"flex p-2",style:{height:P,maxHeight:P},children:[(0,E.jsx)("div",{className:"ml-1 flex h-full w-5 items-center justify-center",children:X?(0,E.jsx)(O.Z,{className:"!h-5 !w-5"}):(0,E.jsx)(h.Z,{width:14,height:14})}),(0,E.jsx)("input",{autoComplete:"off",autoFocus:!0,className:"ml-2 w-[70%] truncate bg-transparent text-sm outline-none placeholder:text-xs placeholder:text-v2-lily/30",placeholder:c.ag._({id:"zVlBJ4"}),onChange:function(e){return oe(e)}}),(0,E.jsx)("div",{className:"absolute right-3 top-3 cursor-pointer rounded bg-v2-background-dark p-1.5 text-xs text-v2-lily/50 focus:bg-red-100",onClick:null!==r&&void 0!==r?r:H,children:"Esc"})]}),(0,E.jsx)("div",{className:"hidden flex-wrap gap-2 p-2 md:flex",children:q.length>0&&q.slice(0,6).map((function(e,r){return(0,E.jsx)(R,{tokenInfo:e,onClick:function(){t(e)},mintsList:n,miniMode:W.includes(e.address)},r)}))}),(0,E.jsx)("div",{className:"flex flex-wrap gap-1 px-2 md:hidden lg:gap-2",children:q.length>0&&q.slice(0,5).map((function(e,r){return(0,E.jsx)(R,{tokenInfo:e,onClick:function(){t(e)},mintsList:n,miniMode:W.includes(e.address)},r)}))}),(0,E.jsx)("div",{className:"pt-3 lg:pt-0",style:{flexGrow:1},children:ne.length>0&&(0,E.jsx)(d.ZP,{children:function(e){var n=e.height,r=void 0===n?0:n,s=e.width,o=void 0===s?0:s;return(0,E.jsx)(f.t7,{ref:de,height:r,itemCount:ne.length,itemSize:g.x,width:o-2,itemData:{mintToUsdValue:ee,searchResult:ne,onSubmit:t,itemsRef:ie,keyboardIndex:ue,setFocusIndex:ce,suppressCloseModal:a,bestTokens:y,apy:G},className:(0,p.cn)("webkit-scrollbar min-h-[12rem] overflow-y-scroll px-5"),children:L})}})}),(0,E.jsxs)("div",{className:(0,p.cn)("flex items-center justify-center gap-x-2 overflow-hidden text-xs font-semibold text-v2-lily transition-all",j?"max-h-8 p-2":"max-h-0 p-0"),children:[(0,E.jsx)(O.Z,{}),(0,E.jsx)(u.cC,{id:"G6etJA"})]})]})}}}]);
//# sourceMappingURL=7842-9ac6abbd03ed5bc0.js.map